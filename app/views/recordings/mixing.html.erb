<h1 class="text-xl font-bold mb-4">ミキシング: <%= @recording.title %></h1>

<!-- 伴奏アップロード（Turbo対応のまま） -->
<%= form_with model: @recording, url: update_accompaniment_recording_path(@recording), method: :patch, local: false do |f| %>
  <div class="mb-4">
    <%= f.label :accompaniment, "伴奏を選択" %>
    <%= f.file_field :accompaniment, class: "input input-bordered w-full" %>
  </div>
  <%= f.submit "伴奏を更新", class: "btn btn-primary" %>
<% end %>

<% if @recording.accompaniment.attached? %>
  <p class="mt-4">現在の伴奏: <%= @recording.accompaniment.filename.to_s %></p>
<% end %>

<hr class="my-6">

<!-- 音声生成操作（Turbo無効） -->
<div class="flex flex-col gap-4">
  <p class="font-semibold">🎵 録音と伴奏を合成して生成音声を作成</p>

  <% if @recording.generated_audio.attached? %>
    <audio controls class="w-full">
      <source src="<%= url_for(@recording.generated_audio) %>" type="audio/wav">
      お使いのブラウザは audio タグに対応していません。
    </audio>
  <% end %>

  <%= button_to "生成音声を作成", generate_audio_recording_path(@recording),
        method: :post,
        form_class: "w-full",
        class: "btn btn-success",
        data: { turbo: false } %> <!-- ここでTurbo無効 -->
</div>

<p class="mt-6"><%= link_to "戻る", new_recording_path, class: "btn btn-outline" %></p>
